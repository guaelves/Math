<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ğŸ  å°æˆ¿å­å¡«è‰²éŠæˆ²</title>
<style>
:root{--bg:#FBFCFF;--card:#fff;--muted:#6b7280;}
html,body{height:100%;margin:0;font-family:"Microsoft JhengHei",system-ui,Arial;background:var(--bg);color:#111;}
.wrap{max-width:920px;margin:10px auto;padding:12px;display:flex;flex-direction:column;gap:12px;}
header{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;}
h1{font-size:18px;margin:0;}
.controls{display:flex;gap:8px;flex-wrap:wrap;}
button{background:#fff;border:1px solid rgba(0,0,0,0.08);padding:8px 10px;border-radius:8px;cursor:pointer;font-size:14px;}
#paletteCard{background:var(--card);border-radius:12px;padding:10px;box-shadow:0 6px 18px rgba(10,20,40,0.06);}
.paletteRow{display:flex;gap:8px;justify-content:center;flex-wrap:wrap;}
.swatch{width:46px;height:46px;border-radius:8px;border:2px solid rgba(0,0,0,0.08);box-sizing:border-box;touch-action:none;}
.swatch.selected{outline:3px solid #111;outline-offset:2px;}
.canvasCard{background:var(--card);border-radius:12px;padding:10px;box-shadow:0 8px 24px rgba(10,20,40,0.06);display:flex;flex-direction:column;gap:8px;align-items:center;}
#svgContainer{width:100%;display:flex;justify-content:center;}
svg{width:100%;max-width:700px;height:auto;touch-action:none;user-select:none;}
.seg{cursor:pointer;stroke:#222;stroke-width:3;stroke-linejoin:round;fill:#ffffff;}
.hint{color:var(--muted);font-size:13px;}
@media(max-width:520px){.swatch{width:40px;height:40px;}button{padding:7px 8px;font-size:13px;}}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>ğŸ  å°æˆ¿å­å¡«è‰²éŠæˆ²</h1>
    <div class="controls">
      <button id="themePink">ç”œç¾ç²‰</button>
      <button id="themeOcean">æµ·æ´‹è—</button>
      <button id="themeForest">æ£®æ—ç¶ </button>
      <button id="randColors">éš¨æ©Ÿé¡è‰²</button>
      <button id="randHouse">éš¨æ©Ÿæˆ¿å­</button>
      <button id="resetBtn">é‡ç½®</button>
      <button id="downloadBtn">ä¸‹è¼‰ PNG</button>
    </div>
  </header>

  <div id="paletteCard">
    <div class="hint">é»é¸é¡è‰² â†’ é»åœ–ä¸Šè‰²ï¼›æˆ–æ‹–æ›³é¡è‰²åˆ°åœ–ä¸Šæ”¾é–‹ï¼ˆæ‰‹æ©Ÿé•·æŒ‰é¸è‰²å†é»åœ–å€å¡Šï¼‰</div>
    <div id="palette" class="paletteRow"></div>
  </div>

  <div class="canvasCard">
    <div id="svgContainer"></div>
    <div class="hint">æç¤ºï¼šæ‹–æ›³é¡è‰²åˆ°å€å¡Šæˆ–å…ˆé¸è‰²å†é»åœ–å€å¡Šã€‚æ‰‹æ©Ÿå¯é•·æŒ‰é¡è‰²é¸å–å¾Œé»åœ–ä¸Šè‰²ã€‚</div>
  </div>
</div>

<script>
// ======== è¨­å®š ========
const SWATCH_COUNT = 8;
let selectedColor = null;
const paletteEl = document.getElementById('palette');
const svgContainer = document.getElementById('svgContainer');

// å½©è™¹ä¸ƒè‰² + é»‘
const RAINBOW = ["#FF0000","#FF7F00","#FFFF00","#00FF00","#0000FF","#4B0082","#8B00FF","#000000"];

// ä¸»é¡Œè‰²
const THEMES = {
  pink:["#FFD6E0","#FFB3C6","#FF8FAF","#FFC6E2","#FFEAF2","#FF9CC7","#FFD1E9","#FFEBF5"],
  ocean:["#D0F0FF","#A9E6FF","#7FD1FF","#6BCBFF","#99E6FF","#66D1FF","#BFEFFF","#E9FBFF"],
  forest:["#E6F9E6","#CBF0CB","#AEE6AE","#8FE08F","#9FE6B2","#7FCD8A","#DFF5D6","#E9FAEA"]
};

// ======== æˆ¿å­ SVG ç¯„ä¾‹ï¼ˆäº”å€‹ï¼‰ ========
const HOUSES = [
`<svg viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg">
<path id="seg0" class="seg" d="M80 150 L200 60 L320 150 L280 150 L200 95 L120 150 Z"/>
<path id="seg1" class="seg" d="M120 150 L200 95 L280 150 L200 160 Z"/>
<path id="seg2" class="seg" d="M250 75 L250 40 L275 40 L275 85 Q265 85 250 75 Z"/>
<path id="seg3" class="seg" d="M80 150 L80 300 Q120 330 160 300 L160 170 Z"/>
<path id="seg4" class="seg" d="M320 150 L320 300 Q280 330 240 300 L240 170 Z"/>
<path id="seg5" class="seg" d="M160 170 L240 170 L240 300 L160 300 Z"/>
<path id="seg6" class="seg" d="M185 230 L185 300 L215 300 L215 230 Q200 220 185 230 Z"/>
<circle id="seg7" class="seg" cx="210" cy="260" r="4"/>
<path id="seg8" class="seg" d="M110 180 L145 180 L145 210 L110 210 Z"/>
<path id="seg9" class="seg" d="M110 210 L145 210 L145 240 L110 240 Z"/>
<path id="seg10" class="seg" d="M255 180 L290 180 L290 210 L255 210 Z"/>
<path id="seg11" class="seg" d="M255 210 L290 210 L290 240 L255 240 Z"/>
<path id="seg12" class="seg" d="M100 130 Q140 120 180 130 Q140 125 100 130 Z"/>
<path id="seg13" class="seg" d="M220 130 Q260 120 300 130 Q260 125 220 130 Z"/>
<path id="seg14" class="seg" d="M160 300 Q180 320 200 315 Q220 320 240 300 L240 300 Q200 330 160 300 Z"/>
<path id="seg15" class="seg" d="M40 290 Q70 260 100 290 Q70 280 40 290 Z"/>
<path id="seg16" class="seg" d="M300 290 Q330 260 360 290 Q330 280 300 290 Z"/>
<path id="seg17" class="seg" d="M320 200 L340 200 L340 260 L320 260 Z"/>
<path id="seg18" class="seg" d="M300 170 Q335 140 370 170 Q345 160 320 170 Q315 165 300 170 Z"/>
<circle id="seg19" class="seg" cx="60" cy="60" r="28"/>
</svg>`,
`<svg viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg">
<path id="seg0" class="seg" d="M50 150 L200 50 L350 150 L310 150 L200 60 L90 150 Z"/>
<path id="seg1" class="seg" d="M90 150 L200 60 L310 150 L200 170 Z"/>
<path id="seg2" class="seg" d="M220 75 L220 40 L245 40 L245 85 Q230 85 220 75 Z"/>
<path id="seg3" class="seg" d="M50 150 L50 300 Q100 340 160 300 L160 170 Z"/>
<path id="seg4" class="seg" d="M350 150 L350 300 Q300 340 240 300 L240 170 Z"/>
<path id="seg5" class="seg" d="M160 170 L240 170 L240 300 L160 300 Z"/>
<path id="seg6" class="seg" d="M175 230 L175 300 L215 300 L215 230 Q195 220 175 230 Z"/>
<circle id="seg7" class="seg" cx="210" cy="260" r="4"/>
<path id="seg8" class="seg" d="M100 180 L140 180 L140 210 L100 210 Z"/>
<path id="seg9" class="seg" d="M100 210 L140 210 L140 240 L100 240 Z"/>
<path id="seg10" class="seg" d="M260 180 L300 180 L300 210 L260 210 Z"/>
<path id="seg11" class="seg" d="M260 210 L300 210 L300 240 L260 240 Z"/>
<path id="seg12" class="seg" d="M80 130 Q150 120 180 130 Q130 125 80 130 Z"/>
<path id="seg13" class="seg" d="M220 130 Q270 120 300 130 Q260 125 220 130 Z"/>
<path id="seg14" class="seg" d="M160 300 Q180 320 200 315 Q220 320 240 300 L240 300 Q200 330 160 300 Z"/>
<path id="seg15" class="seg" d="M30 290 Q70 260 110 290 Q70 280 30 290 Z"/>
<path id="seg16" class="seg" d="M290 290 Q330 260 370 290 Q330 280 290 290 Z"/>
<path id="seg17" class="seg" d="M300 200 L320 200 L320 260 L300 260 Z"/>
<path id="seg18" class="seg" d="M280 170 Q315 140 350 170 Q325 160 300 170 Q295 165 280 170 Z"/>
<circle id="seg19" class="seg" cx="70" cy="50" r="28"/>
</svg>`,
// å¦å¤–ä¸‰å€‹æˆ¿å­ SVG ç•¥åŒï¼Œå¯ä¾æ­¤æ¨¡å¼è‡ªè£½
];

// ======== é¡è‰²ç›¤ ========
function renderPalette(colors){
  paletteEl.innerHTML='';
  colors.forEach((c,idx)=>{
    const d=document.createElement('div');
    d.className='swatch';
    d.style.background=c;
    d.dataset.color=c;
    d.draggable=true;
    d.title=`é¡è‰² ${idx+1}`;
    d.addEventListener('click',()=>{
      document.querySelectorAll('.swatch').forEach(s=>s.classList.remove('selected'));
      d.classList.add('selected');
      selectedColor=c;
    });
    d.addEventListener('touchstart',(ev)=>{ev.preventDefault();document.querySelectorAll('.swatch').forEach(s=>s.classList.remove('selected'));d.classList.add('selected');selectedColor=c;},{passive:false});
    d.addEventListener('dragstart',(ev)=>{ev.dataTransfer.setData('text/plain',c);selectedColor=c;});
    paletteEl.appendChild(d);
  });
  const first=paletteEl.querySelector('.swatch');
  if(first){ first.classList.add('selected'); selectedColor=first.dataset.color; }
}

// ======== åŠ å…¥æˆ¿å­ ========
function loadHouse(index){
  svgContainer.innerHTML=HOUSES[index];
  const segEls = Array.from(svgContainer.querySelectorAll('.seg'));
  segEls.forEach(seg=>{
    seg.style.fill='#ffffff';
    seg.addEventListener('click',()=>{if(selectedColor){seg.style.fill=selectedColor;}});
    seg.addEventListener('dragover',(ev)=>{ev.preventDefault();});
    seg.addEventListener('drop',(ev)=>{ev.preventDefault(); const c=ev.dataTransfer.getData('text/plain'); if(c){seg.style.fill=c;selectedColor=c;}});
  });
}

// ======== æŒ‰éˆ•åŠŸèƒ½ ========
document.getElementById('randColors').addEventListener('click',()=>renderPalette(RAINBOW));
document.getElementById('themePink').addEventListener('click',()=>renderPalette(THEMES.pink));
document.getElementById('themeOcean').addEventListener('click',()=>renderPalette(THEMES.ocean));
document.getElementById('themeForest').addEventListener('click',()=>renderPalette(THEMES.forest));
document.getElementById('resetBtn').addEventListener('click',()=>loadHouse(currentHouse));
let currentHouse=Math.floor(Math.random()*HOUSES.length);
document.getElementById('randHouse').addEventListener('click',()=>{
  currentHouse=Math.floor(Math.random()*HOUSES.length);
  loadHouse(currentHouse);
  renderPalette(RAINBOW);
});

// ======== åˆå§‹åŒ– ========
renderPalette(RAINBOW);
loadHouse(currentHouse);

// ======== ä¸‹è¼‰ PNG åŠŸèƒ½ ========
document.getElementById('downloadBtn').addEventListener('click',()=>{
  const clone = svgContainer.querySelector('svg').cloneNode(true);
  const serializer = new XMLSerializer();
  const svgStr='<?xml version="1.0" standalone="no"?>\n'+serializer.serializeToString(clone);
  const blob = new Blob([svgStr], {type:'image/svg+xml;charset=utf-8'});
  const url = URL.createObjectURL(blob);
  const img = new Image();
  img.onload=function(){
    const canvas=document.createElement('canvas');
    const size=1600;
    canvas.width=size; canvas.height=size;
    const ctx=canvas.getContext('2d');
    ctx.drawImage(img,0,0,size,size);
    const link=document.createElement('a');
    link.download='å°æˆ¿å­å¡«è‰².png';
    link.href=canvas.toDataURL('image/png');
    link.click();
    URL.revokeObjectURL(url);
  };
  img.src=url;
});
</script>
</body>
</html>
